<span class="section-header">플레이 제어</span>
<div class="audio-btns" style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
    <button id="playBtn" class="btn-action"><i data-lucide="play" size="16"></i>재생 (Pos)</button>
    <button id="resetBtn" class="btn-action"><i data-lucide="arrow-down-to-line" size="16"></i>처음으로</button>
</div>

<script>
    let playStartTime = 0;
    let syncAnimFrame = null;

    function initPlay() {
        document.getElementById('playBtn').onclick = togglePlay;
        document.getElementById('resetBtn').onclick = () => { stopPlayback(); document.getElementById('viewport').scrollTop = currentChartHeight; };
    }

    function togglePlay() {
        if (isPlaying) { stopPlayback(); return; }
        if (!audioBuffer) return;

        const viewport = document.getElementById('viewport');
        const currentHitlineY = viewport.scrollTop + viewport.clientHeight - HITLINE_OFFSET;
        audioStartOffset = ( (currentChartHeight - (PADDING_SEC * pixelsPerBeat * (parseFloat(document.getElementById('bpmInput').value)/60))) - currentHitlineY ) / pixelsPerBeat * (60/parseFloat(document.getElementById('bpmInput').value));

        // 3초 카운트다운 로직...
        startAudio(audioStartOffset);
    }

    function startAudio(offset) {
        sourceNode = audioCtx.createBufferSource();
        sourceNode.buffer = audioBuffer;
        sourceNode.connect(audioCtx.destination);
        isPlaying = true;
        playStartTime = audioCtx.currentTime;
        sourceNode.start(0, Math.max(0, offset));
        requestAnimationFrame(updateSync);
    }

    function updateSync() {
        if (!isPlaying) return;
        // 스크롤 위치 동기화 및 renderVisibleNotes 호출 로직...
        requestAnimationFrame(updateSync);
    }

    function stopPlayback() {
        if (sourceNode) sourceNode.stop();
        isPlaying = false;
    }
</script>
